<!DOCTYPE html>
{% load static %}
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>{{ product.name }}</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script>
        $(document).ready(function() {
            $('form').on('submit', function(event) {
                event.preventDefault(); // Останавливаем обычное отправление формы

                const form = $(this);
                const url = form.attr('action'); // Получаем URL из атрибута action
                const data = form.serialize(); // Сериализуем данные формы

                $.ajax({
                    type: 'POST',
                    url: url,
                    data: data,
                    success: function(response) {
                        // Обновляем текст кнопки или добавляем уведомление
                        $('#add-to-cart-button').text('Товар добавлен в корзину');
                        // Можно также обновить количество товаров в корзине
                        $('#total-cart-count').text(parseInt($('#total-cart-count').text()) + 1);
                    },
                    error: function() {
                        alert('Ошибка при добавлении товара в корзину.');
                    }
                });
            });
        });
    </script>
</head>
<body>
    <a href="{% url 'shop' %}">Вернуться в магазин</a>
    <h1>{{ product.name }}</h1>
    <p>{{ product.description }}</p>
    <p>Цена: {{ product.price }} ₽</p>
    {% if product.image %}
        <img src="{{ product.image.url }}" alt="{{ product.name }}">
    {% endif %}
    <form action="{% url 'add_to_cart' product.id %}" method="post">
        {% csrf_token %}
        <button type="submit" id="add-to-cart-button">Добавить в корзину</button>
    </form>
</body>
</html>

